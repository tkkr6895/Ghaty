<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Western Ghats LULC Side-by-Side Comparison</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            height: 100vh;
            overflow: hidden;
        }
        
        #header {
            background: linear-gradient(135deg, #2E7D32 0%, #1B5E20 100%);
            color: white;
            padding: 15px 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 1000;
        }
        
        #header h1 {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }
        
        #header .subtitle {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        #controls {
            background: white;
            padding: 15px 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .control-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .control-group label {
            font-weight: 600;
            font-size: 0.9rem;
            color: #333;
        }
        
        .control-group select,
        .control-group button {
            padding: 8px 15px;
            font-size: 0.9rem;
            border: 2px solid #2E7D32;
            border-radius: 5px;
            cursor: pointer;
            background: white;
        }
        
        .control-group button {
            background: #2E7D32;
            color: white;
            font-weight: 600;
        }
        
        .control-group button:hover {
            background: #1B5E20;
        }
        
        #map-container {
            display: flex;
            height: calc(100vh - 135px);
        }
        
        .map-panel {
            flex: 1;
            position: relative;
            border-right: 2px solid #ccc;
        }
        
        .map-panel:last-child {
            border-right: none;
        }
        
        .map-panel h3 {
            position: absolute;
            top: 10px;
            left: 50px;
            background: white;
            padding: 10px 15px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 500;
            font-size: 1rem;
            color: #2E7D32;
        }
        
        .map {
            width: 100%;
            height: 100%;
        }
        
        .legend {
            position: absolute;
            bottom: 30px;
            right: 10px;
            background: white;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            z-index: 500;
            max-width: 200px;
        }
        
        .legend h4 {
            margin-bottom: 10px;
            font-size: 0.9rem;
            color: #333;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 5px;
            font-size: 0.85rem;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
            border: 1px solid #ccc;
        }
        
        .info-box {
            position: absolute;
            top: 80px;
            left: 50px;
            background: white;
            padding: 10px 15px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 500;
            font-size: 0.85rem;
            max-width: 250px;
        }
        
        .info-box strong {
            color: #2E7D32;
        }
        
        .layer-control {
            position: absolute;
            top: 120px;
            right: 10px;
            background: white;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 500;
        }
        
        .layer-control label {
            display: block;
            margin-bottom: 5px;
            font-size: 0.85rem;
            cursor: pointer;
        }
        
        .layer-control input {
            margin-right: 5px;
        }
    </style>
</head>
<body>
    <div id="header">
        <h1>Western Ghats LULC Comparison Tool</h1>
        <div class="subtitle">Side-by-Side Analysis with Satellite & Basemap Views</div>
    </div>
    
    <div id="controls">
        <div class="control-group">
            <label for="leftYear">Left Map Year:</label>
            <select id="leftYear">
                <option value="1987">1987 (GLC-FCS30D)</option>
                <option value="1992">1992 (GLC-FCS30D)</option>
                <option value="1997">1997 (GLC-FCS30D)</option>
                <option value="2000">2000 (GLC-FCS30D)</option>
                <option value="2005">2005 (GLC-FCS30D)</option>
                <option value="2010">2010 (GLC-FCS30D)</option>
                <option value="2015">2015 (GLC-FCS30D)</option>
                <option value="2018">2018 (Dynamic World)</option>
                <option value="2020">2020 (Dynamic World)</option>
                <option value="2022">2022 (Dynamic World)</option>
                <option value="2025" selected>2025 (Dynamic World)</option>
            </select>
        </div>
        
        <div class="control-group">
            <label for="rightYear">Right Map Year:</label>
            <select id="rightYear">
                <option value="1987" selected>1987 (GLC-FCS30D)</option>
                <option value="1992">1992 (GLC-FCS30D)</option>
                <option value="1997">1997 (GLC-FCS30D)</option>
                <option value="2000">2000 (GLC-FCS30D)</option>
                <option value="2005">2005 (GLC-FCS30D)</option>
                <option value="2010">2010 (GLC-FCS30D)</option>
                <option value="2015">2015 (GLC-FCS30D)</option>
                <option value="2018">2018 (Dynamic World)</option>
                <option value="2020">2020 (Dynamic World)</option>
                <option value="2022">2022 (Dynamic World)</option>
                <option value="2025">2025 (Dynamic World)</option>
            </select>
        </div>
        
        <div class="control-group">
            <label for="layerType">Layer Type:</label>
            <select id="layerType">
                <option value="trees">Tree Cover</option>
                <option value="built">Built Area</option>
                <option value="full">Full LULC</option>
            </select>
        </div>
        
        <div class="control-group">
            <button onclick="updateMaps()">Update Maps</button>
            <button onclick="syncMaps()">Sync Maps</button>
        </div>
    </div>
    
    <div id="map-container">
        <div class="map-panel">
            <h3 id="leftTitle">2025 - Dynamic World</h3>
            <div class="info-box">
                <strong>Instructions:</strong><br>
                1. Select years to compare<br>
                2. Choose layer type<br>
                3. Click "Update Maps"<br>
                4. Use "Sync Maps" to link panning/zooming
            </div>
            <div id="map-left" class="map"></div>
            <div class="legend">
                <h4>Land Cover</h4>
                <div class="legend-item">
                    <div class="legend-color" style="background: #419BDF;"></div>
                    <span>Water</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #397D49;"></div>
                    <span>Trees</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #E49635;"></div>
                    <span>Crops</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #C4281B;"></div>
                    <span>Built</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #A59B8F;"></div>
                    <span>Bare</span>
                </div>
            </div>
        </div>
        
        <div class="map-panel">
            <h3 id="rightTitle">1987 - GLC-FCS30D</h3>
            <div id="map-right" class="map"></div>
            <div class="layer-control">
                <h4 style="margin-bottom: 8px; font-size: 0.9rem;">Base Layers</h4>
                <label><input type="radio" name="basemap" value="osm" checked> OpenStreetMap</label>
                <label><input type="radio" name="basemap" value="satellite"> Satellite</label>
                <label><input type="radio" name="basemap" value="terrain"> Terrain</label>
            </div>
        </div>
    </div>
    
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script>
        // Initialize maps
        const leftMap = L.map('map-left').setView([13.0, 75.5], 8);
        const rightMap = L.map('map-right').setView([13.0, 75.5], 8);
        
        // Base layers
        const baseLayers = {
            osm: L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors'
            }),
            satellite: L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
                attribution: 'Tiles © Esri'
            }),
            terrain: L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenTopoMap contributors'
            })
        };
        
        // Add default base layer
        baseLayers.osm.addTo(leftMap);
        baseLayers.osm.addTo(rightMap);
        
        // Handle base layer switching
        document.querySelectorAll('input[name="basemap"]').forEach(radio => {
            radio.addEventListener('change', function() {
                Object.values(baseLayers).forEach(layer => {
                    leftMap.removeLayer(layer);
                    rightMap.removeLayer(layer);
                });
                baseLayers[this.value].addTo(leftMap);
                baseLayers[this.value].addTo(rightMap);
            });
        });
        
        // Store current overlay layers
        let leftOverlay = null;
        let rightOverlay = null;
        
        // Sync maps function
        let mapsSynced = false;
        function syncMaps() {
            if (!mapsSynced) {
                leftMap.sync(rightMap);
                rightMap.sync(leftMap);
                mapsSynced = true;
                alert('Maps synchronized! Pan and zoom will now be linked.');
            } else {
                leftMap.unsync(rightMap);
                rightMap.unsync(leftMap);
                mapsSynced = false;
                alert('Maps unsynchronized.');
            }
        }
        
        // Simple sync implementation (since L.Map.Sync might not be available)
        L.Map.prototype.sync = function(map) {
            this._syncMap = map;
            this.on('moveend', this._syncMove, this);
        };
        
        L.Map.prototype.unsync = function(map) {
            if (this._syncMap) {
                this.off('moveend', this._syncMove, this);
                this._syncMap = null;
            }
        };
        
        L.Map.prototype._syncMove = function() {
            if (this._syncMap && !this._syncMoving) {
                this._syncMoving = true;
                this._syncMap.setView(this.getCenter(), this.getZoom(), {animate: false});
                this._syncMoving = false;
            }
        };
        
        // Update maps based on selections
        function updateMaps() {
            const leftYear = document.getElementById('leftYear').value;
            const rightYear = document.getElementById('rightYear').value;
            const layerType = document.getElementById('layerType').value;
            
            // Update titles
            document.getElementById('leftTitle').textContent = `${leftYear} - ${leftYear >= 2018 ? 'Dynamic World' : 'GLC-FCS30D'}`;
            document.getElementById('rightTitle').textContent = `${rightYear} - ${rightYear >= 2018 ? 'Dynamic World' : 'GLC-FCS30D'}`;
            
            // Instructions for loading shapefiles
            alert(`To view the data:
            
1. Download shapefiles from Google Drive:
   - Historical: Western_Ghats_Shapefiles folder
   - Recent: Western_Ghats_Tree_Cover and Western_Ghats_Built_Area folders

2. Convert shapefiles to GeoJSON:
   - Use QGIS: Vector > Save As > GeoJSON
   - Or use online converter: mapshaper.org

3. Place GeoJSON files in the same folder as this HTML

4. Update the code below to load your files:

Expected file names:
   - trees_${leftYear}.geojson
   - built_${leftYear}.geojson
   - trees_${rightYear}.geojson
   - built_${rightYear}.geojson

Selected layer type: ${layerType}
Left year: ${leftYear}
Right year: ${rightYear}

Note: This is a template. You'll need to add your converted GeoJSON files.`);
            
            // Example of how to load GeoJSON (uncomment and modify when files are ready)
            /*
            // Remove existing overlays
            if (leftOverlay) leftMap.removeLayer(leftOverlay);
            if (rightOverlay) rightMap.removeLayer(rightOverlay);
            
            // Load left map layer
            fetch(`${layerType}_${leftYear}.geojson`)
                .then(response => response.json())
                .then(data => {
                    leftOverlay = L.geoJSON(data, {
                        style: function(feature) {
                            return {
                                color: layerType === 'trees' ? '#397D49' : '#C4281B',
                                weight: 1,
                                fillOpacity: 0.6
                            };
                        }
                    }).addTo(leftMap);
                    
                    // Zoom to layer
                    leftMap.fitBounds(leftOverlay.getBounds());
                })
                .catch(err => console.error('Error loading left layer:', err));
            
            // Load right map layer
            fetch(`${layerType}_${rightYear}.geojson`)
                .then(response => response.json())
                .then(data => {
                    rightOverlay = L.geoJSON(data, {
                        style: function(feature) {
                            return {
                                color: layerType === 'trees' ? '#397D49' : '#C4281B',
                                weight: 1,
                                fillOpacity: 0.6
                            };
                        }
                    }).addTo(rightMap);
                    
                    // Zoom to layer
                    rightMap.fitBounds(rightOverlay.getBounds());
                })
                .catch(err => console.error('Error loading right layer:', err));
            */
        }
        
        // Add Western Ghats boundary (approximate)
        const westernGhatsBounds = [
            [8.0, 73.0],
            [21.0, 77.5]
        ];
        
        // Draw boundary rectangle
        const boundaryStyle = {
            color: '#2E7D32',
            weight: 2,
            fill: false,
            dashArray: '5, 5'
        };
        
        L.rectangle(westernGhatsBounds, boundaryStyle).addTo(leftMap);
        L.rectangle(westernGhatsBounds, boundaryStyle).addTo(rightMap);
        
        // Fit maps to Western Ghats region
        leftMap.fitBounds(westernGhatsBounds);
        rightMap.fitBounds(westernGhatsBounds);
        
        console.log('Maps initialized successfully!');
        console.log('To load shapefiles:');
        console.log('1. Convert your shapefiles to GeoJSON format');
        console.log('2. Place them in the same directory as this HTML file');
        console.log('3. Uncomment the fetch() code in updateMaps() function');
        console.log('4. Update file names to match your GeoJSON files');
    </script>
</body>
</html>
